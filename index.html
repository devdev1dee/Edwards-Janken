<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edward's Fate - Pixel Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DotGothic16&display=swap');

        body { 
            background: #1a1a1a; color: #fff; text-align: center; 
            font-family: 'DotGothic16', sans-serif; image-rendering: pixelated; 
            margin: 0; padding: 20px; overflow: hidden;
        }

        #game-wrapper { position: relative; max-width: 600px; margin: auto; }

        #game-container { 
            border: 4px solid #fff; background: #000; padding: 20px; 
            box-shadow: 8px 8px 0px #000; position: relative;
        }

        /* TIMER STYLES */
        #timer-container {
            position: absolute; right: -80px; top: 0;
            width: 70px; border: 3px solid #fff; padding: 10px 5px; background: #000;
        }
        #timer-val { font-size: 1.5rem; color: #ff0000; }

        /* EDWARD'S HEALTH BAR */
        .health-section { margin-bottom: 20px; }
        .bar-label { font-size: 0.9rem; margin-bottom: 5px; color: #aaa; text-align: left; }
        #health-bar-container { width: 100%; height: 25px; background: #222; border: 3px solid #fff; }
        #health-fill { width: 100%; height: 100%; background: #ff0000; transition: width 0.3s steps(4); }

        #screen { 
            width: 100%; height: 300px; background: #0a0a0a; 
            display: flex; align-items: center; justify-content: center; 
            border: 2px solid #333; margin-bottom: 20px;
        }
        img { max-width: 100%; max-height: 100%; image-rendering: pixelated; }

        .controls { display: flex; justify-content: center; gap: 10px; min-height: 50px; }
        button { 
            padding: 10px 15px; cursor: pointer; background: #000; color: #fff; 
            border: 3px solid #fff; font-family: 'DotGothic16', sans-serif;
        }
        button:hover:not(:disabled) { background: #fff; color: #000; }
        button:disabled { border-color: #444; color: #444; cursor: not-allowed; }

        /* REPLAY BUTTON - BOTTOM RIGHT */
        #replay-btn {
            display: none; position: fixed; bottom: 20px; right: 20px;
            padding: 15px; background: #ff0000; color: #fff; border: 3px solid #fff;
            cursor: pointer; font-family: 'DotGothic16', sans-serif;
            box-shadow: 4px 4px 0px #000;
        }

        #message { height: 2em; margin: 15px 0; font-size: 1.2rem; }
    </style>
</head>
<body>

    <div id="game-wrapper">
        <div id="timer-container">
            <div style="font-size: 0.7rem;">TIME</div>
            <div id="timer-val">50</div>
        </div>

        <div id="game-container">
            <div class="health-section">
                <div class="bar-label">EDWARD_HP</div>
                <div id="health-bar-container"><div id="health-fill"></div></div>
            </div>

            <div id="screen"><img id="game-frame" src="edward_idle.png"></div>
            <div id="message">BEAT HIM BEFORE TIME RUNS OUT!</div>
            
            <div class="controls" id="rps-controls">
                <button onclick="playJanken('rock')">ROCK</button>
                <button onclick="playJanken('paper')">PAPER</button>
                <button onclick="playJanken('scissors')">SCISSORS</button>
            </div>

            <div class="controls" id="dir-controls" style="display:none;">
                <button onclick="playDirection('up')">UP</button>
                <button onclick="playDirection('down')">DOWN</button>
                <button onclick="playDirection('left')">LEFT</button>
                <button onclick="playDirection('right')">RIGHT</button>
            </div>
        </div>
    </div>

    <button id="replay-btn" onclick="location.reload()">â†º REPLAY</button>

    <script>
        let health = 100;
        let timeLeft = 50;
        let gameActive = true;
        let timerStarted = false;

        const frame = document.getElementById('game-frame');
        const msg = document.getElementById('message');
        const rps = document.getElementById('rps-controls');
        const dirs = document.getElementById('dir-controls');
        const healthFill = document.getElementById('health-fill');
        const timerDisplay = document.getElementById('timer-val');
        const replayBtn = document.getElementById('replay-btn');

        function startTimer() {
            if (timerStarted) return;
            timerStarted = true;
            let timerInterval = setInterval(() => {
                if (!gameActive) {
                    clearInterval(timerInterval);
                    return;
                }
                timeLeft--;
                timerDisplay.innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    endGame(false); // Edward wins (Player ran out of time)
                }
            }, 1000);
        }

        function playJanken(playerChoice) {
            if (!gameActive) return;
            startTimer();
            if (playerChoice === 'rock') {
                frame.src = 'edward_surprised.png';
                msg.innerText = "WIN! LOOK THAT WAY!";
                showDirections();
            } else if (playerChoice === 'paper') {
                frame.src = 'edward_win_throw.png';
                msg.innerText = "LOSE! TRY AGAIN!";
                setTimeout(resetRound, 1000);
            } else {
                frame.src = 'edward_tie.png';
                msg.innerText = "TIE!";
            }
        }

        function showDirections() {
            rps.style.display = 'none';
            dirs.style.display = 'flex';
        }

        function playDirection(playerDir) {
            const choices = ['up', 'down', 'left', 'right'];
            const edwardLook = choices[Math.floor(Math.random() * 4)];
            frame.src = 'edward_looks_' + edwardLook + '.png';
            
            if (playerDir === edwardLook) {
                health -= 25;
                healthFill.style.width = health + "%";
                msg.innerText = "HIT!";
                if (health <= 0) endGame(true); // Player wins
                else setTimeout(resetRound, 1000);
            } else {
                msg.innerText = "MISS!";
                setTimeout(resetRound, 1000);
            }
        }

        function resetRound() {
            if (gameActive) {
                frame.src = 'edward_idle.png';
                rps.style.display = 'flex';
                dirs.style.display = 'none';
            }
        }

        function endGame(playerWon) {
            gameActive = false;
            rps.style.display = 'none';
            dirs.style.display = 'none';
            replayBtn.style.display = 'block';
            
            if (playerWon) {
                frame.src = 'victory_screen.png';
                msg.innerText = "YOU WIN! EDWARD RETIRES.";
            } else {
                frame.src = 'edward_win_throw.png'; // Show him winning
                msg.innerText = "TIME UP! EDWARD WINS.";
            }
        }
    </script>
</body>
</html>
